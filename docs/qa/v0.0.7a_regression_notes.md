# v0.0.7a Regression Notes

Date: 2026-02-11
APP_VERSION: v0.0.7a
SIM_VERSION: mvp_v0_1

## Summary
- `npm run qa` is intended to be robust in environments where `npm install` may fail (via a no-deps fallback gate).
- **Resolved in this package:** the no-deps gate now executes cleanly without `node_modules`.

## Fix confirmed
### dist_batch Node ESM compatibility
- `dist_batch/src/**/*.js` now uses explicit `.js` extensions in relative ESM import/export specifiers.
- This eliminates the prior runtime failure:
  - `ERR_MODULE_NOT_FOUND` when importing `dist_batch/src/sim/*`.

## Evidence
- `npm run qa` (no deps) exits `0`.
- Machine-readable artifact written:
  - `qa_artifacts/v0.0.7a_no_deps_gate.json` (`ok: true`, `passed: 6/6`).

## Remaining recommendations (non-balance)
1) **Make the fix reproducible in the build pipeline**
   - Preferred: configure the dist_batch emit step to include `.js` in ESM specifiers directly.
   - Practical: keep a postbuild rewrite step (e.g., `scripts/_fix_dist_batch_imports.mjs`) and run it as part of the packaging/build.

2) **Add a CI regression check for the no-deps path**
   - Remove/skip `node_modules` and run `npm run qa`.
   - Expectation: `qa_artifacts/v0.0.X_no_deps_gate.json` exists and `ok: true`.

3) **Optional: parity signal with vitest gate**
   - When `node_modules` exists, ensure `qa_artifacts/vitest.json` is produced and `numTotalTests > 0`.
   - This protects against accidental include/exclude patterns causing a false PASS.
