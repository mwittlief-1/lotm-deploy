# v0.2.3.2 TASKS â€” Dev Agent B (Sim Correctness)
**Last Updated:** 2026-02-15

## Inputs
- Baseline repo zip: latest v0.2.3.1 deployable certified (Golden Layout)
- UX docs in this package: `docs/ux/v0.2.3_copy.md` (includes v0.2.3.2 patch addendum sections)

## Scope (P0 Correctness)
1) Household uniqueness (data-level)
- Ensure household/people lists do not duplicate the heir as a second row.
- Heir is represented as a tag/badge only.

2) Widowed semantics
- Surviving spouse gets Widow/Widower/Widowed status; deceased spouse is Deceased.
- Household state must align with house_log.

3) Spouse-death log dedupe
- Ensure spouse death is logged once; do not repeat on subsequent turns.
- Same for widow/widower event.

4) Age sanity (deterministic)
- Initialize family so first child occurs at husband age 22, wife age 18.
- Adjust child ages deterministically from that baseline.
- Mortality/max-age: prevent heads from reaching ~120 (hard cap or mortality curve adjustment).

5) Labor oversubscription correctness
- Clamp farmers/builders so farmers+builders <= population always.
- If population drops below assigned labor, auto-rebalance (builders first).
- Ensure player can correct oversubscription even when labor delta cap would otherwise block.
- Emit a structured flag/state signal so UI can show UX-specified banners/toasts.

## P1 Support (data needed for UI)
6) Unrest delta breakdown data
- Provide structured breakdown for unrest changes (before, contributors +/-, after) for UI.
- Keep deterministic and explainable (use existing penalties/events contributions).

7) Construction option availability signal
- Provide a way for UI to know an improvement is already built so it can disable/remove it.

## Deliverable
- `devB_patch_v0.2.3.2_correctness.zip` containing only sim/types/tests/docs changes + `DEV_NOTES.md`.
No UI changes.
