# v0.2.2 Regression Notes

**Date (UTC):** 2026-02-14  
**QA Owner:** QA Engineer

## Summary

- **Gate result:** **CERTIFIABLE PASS** (`npm run qa` succeeds without `node_modules/` via no-deps fallback).
- **Primary change theme:** v0.2.2 External Houses kickoff (worldgen RNG stream isolation + non-destructive People-First sync + deterministic external IDs).

## What changed (high signal)

From `docs/BUILD_INFO.json`:
- Worldgen RNG isolation for external houses/persons (dedicated `worldgen` stream)
- Non-destructive `ensurePeopleFirst()` upsert behavior to preserve externally seeded registries
- Deterministic external IDs (`h_ext_01..`, `p_ext_01_*`)
- UI/clarity patch integrated (“Known Houses” section)

## QA signals observed

### Authoritative gate (`npm run qa`)
- Runs dependency-free against `dist_batch/` when `node_modules` is absent.
- Produced: `qa_artifacts/v0.2.2_no_deps_gate.json`
- Result: **7/7 tests passed**
- Golden seeds loaded from `docs/golden_seeds_v0.2.2.json` (n=8)

### Targeted smoke check (TA-critical)
- Seeded external houses count observed: **9** (within required 5–10)
- `_worldgen_external_houses_v0_2_2` flag present
- External `houses` + `people` key sets persist across at least 1 full resolved turn

## Risk watchlist (non-blocking)

1) **Cross-version non-perturbation proof for RNG streams**
   - TA requires worldgen to not perturb existing streams (weather/events/household/etc).
   - Current gate proves determinism *within* this version, but does not compare hashes vs v0.2.1.
   - Recommendation: add 1–2 “drift sentinel” expectations (stored hash) for stable substructures.

2) **Sorted iteration guarantees**
   - TA requires sorted enumeration of houses/people for stable ordering.
   - Recommendation: add a test that hashes sorted `Object.keys(houses)` / relationship edge ordering and fails on ordering drift.

## BUILD_INFO.sim_version check

`sim_version = "mvp_v0_1"` matches `src/sim/version.ts` in this repo. This appears intentional.
